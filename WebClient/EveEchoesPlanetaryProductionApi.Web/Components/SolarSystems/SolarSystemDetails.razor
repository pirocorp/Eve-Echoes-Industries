@namespace EveEchoesPlanetaryProductionApi.Web.Components.SolarSystems

@using EveEchoesPlanetaryProductionApi.Services.Data.Models.SolarSystems.GetSolarSystemById
@using EveEchoesPlanetaryProductionApi.Web.Services

@inject IAppDataService AppDataService;

<div class="card text-center mx-auto" style="width: 100%">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs">
            <li class="nav-item">
                <NavLink class="nav-link active" href=@($"details/") Match="NavLinkMatch.All" >Details</NavLink>
            </li>
            <li class="nav-item">
                <NavLink class=@($"nav-link {this.NavLinkClass()}") href="@($"best/")" Match="NavLinkMatch.All">Best In System</NavLink>
            </li>
        </ul>
    </div>
    <div class="card-body">
        <h3 class="card-title">System: @this.SolarSystem.Name</h3>
        <h4 class="card-text">Constellation: @this.SolarSystem.ConstellationName</h4>
        <h5 class="card-text">Region: @this.SolarSystem.RegionName</h5>
        
        <div class="just-padding text-left">
            <div class="list-group list-group-root">
                <div class="list-group-item">
                    @foreach (var planet in this.SolarSystem.Planets)
                    {
                        <AllPlanetResourcesTable Planet="planet"></AllPlanetResourcesTable>
                    }
                </div>
            </div>
        </div>

    </div>
</div>

@code {
    [Parameter]
    public SolarSystemServiceModel SolarSystem { get; set; }

    protected override async Task OnInitializedAsync()
    {
        this.AppDataService.CurrentSolarSystem = this.SolarSystem;

        await base.OnInitializedAsync();
    }

    private string NavLinkClass()
    {
        if (this.SolarSystem is null || this.SolarSystem.Planets.Count() is 0)
        {
            return "disabled";
        }

        return string.Empty;
    }
}
